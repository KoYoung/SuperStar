<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.dao.BorLoanInfoDao">
	<!-- 查询个人用户贷款信息 -->
	<select id="findBorLoanInfo" resultType="com.entity.BorLoanInfo">
		select
		bor.bor_name,bi.bankinfo_name,bori.contract_id,
		e.emp_name,lt.loantype_name,bori.loan_number,bori.loan_account,
		bori.loan_date,bori.loan_repayment_date,bori.loan_rate,
		p.pledge_genre,p.pledge_type,p.pledge_name,p.pledge_value,p.pledge_owner,gua.gua_name,lg.lmr_name
		from borrower bor,bankinfo bi,employee e,loantype lt,
		borloaninfo
		bori,customergoods cg,pledge p,guarantor
		gua,borgua bg,loanmanagerecord lg
		where bor.bor_id=bori.bor_id and bi.bankinfo_id=bori.bankinfo_id
		and
		e.emp_id=bori.emp_id and lt.loantype_id=bori.loan_type
		and
		cg.bor_id=bori.bor_id and cg.goods_id=p.pledge_id and
		gua.gua_id=bg.gua_id
		and bg.bor_id=bori.bor_id and
		lg.loaninfo_id=bori.borloaninfo_id
	</select>
	<!-- 添加个人用户贷款信息 -->
	<insert id="addBorLoanInfo" useGeneratedKeys="false"
		parameterType="com.entity.BorLoanInfo">
		insert into borloaninfo
		values(borloaninfo_sequence.nextval,#{borId,jdbcType=VARCHAR},#{bankinfoId,jdbcType=VARCHAR},
		#{contractId,jdbcType=VARCHAR},#{empId,jdbcType=VARCHAR},
		#{loanType,jdbcType=VARCHAR},#{loanNumber,jdbcType=VARCHAR},
		#{loanAccount,jdbcType=VARCHAR},to_date(#{loanDate,jdbcType=VARCHAR},'yyyy-MM-dd'),
		to_date(#{loanRepaymentDate,jdbcType=VARCHAR},'yyyy-MM-dd'),
		#{loanRate,jdbcType=VARCHAR})
	</insert>
</mapper>